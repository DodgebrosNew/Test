<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cart - Lawsuit Marketplace</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-6 font-sans min-h-screen flex flex-col">

  <h1 class="text-3xl font-bold mb-6">Your Cart</h1>

  <div class="mb-6 flex gap-4">
    <a href="index.html" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">Back to Store</a>
    <button id="remove-all" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">Remove All</button>
  </div>

  <div id="cart-container" class="space-y-4 flex-grow">
    <!-- Cart items go here -->
  </div>

  <div id="total-price" class="mt-6 text-xl font-semibold">
    Total: $0.00
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const cartContainer = document.getElementById('cart-container');
      const removeAllBtn = document.getElementById('remove-all');
      const totalPriceEl = document.getElementById('total-price');

      let cart = JSON.parse(localStorage.getItem('cart')) || [];

      if (cart.length === 0) {
        cartContainer.innerHTML = '<p class="text-gray-400">Your cart is empty.</p>';
        totalPriceEl.style.display = 'none';
        removeAllBtn.style.display = 'none';
        return;
      }

      // Helper to parse price strings like "$4.99" to float
      function parsePrice(priceStr) {
        return parseFloat(priceStr.replace('$', '')) || 0;
      }

      // Render cart items
      function renderCart() {
        cartContainer.innerHTML = '';
        let total = 0;

        cart.forEach((product, index) => {
          const price = parsePrice(product.price);
          const itemTotal = price * (product.quantity || 1);
          total += itemTotal;

          const item = document.createElement('div');
          item.className = 'bg-gray-800 p-4 rounded shadow flex justify-between items-center gap-4';

          item.innerHTML = `
            <div class="flex-grow">
              <h2 class="text-xl font-semibold">${product.name}</h2>
              <p class="text-gray-400">${product.price} each</p>
            </div>
            <div class="flex items-center gap-2">
              <button data-index="${index}" data-action="decrease" class="quantity-btn bg-gray-700 px-3 py-1 rounded hover:bg-gray-600">âˆ’</button>
              <span class="quantity text-lg font-semibold">${product.quantity || 1}</span>
              <button data-index="${index}" data-action="increase" class="quantity-btn bg-gray-700 px-3 py-1 rounded hover:bg-gray-600">+</button>
            </div>
            <div class="w-20 text-right font-semibold">$${itemTotal.toFixed(2)}</div>
            <button data-index="${index}" class="remove-btn bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded">Remove</button>
          `;

          cartContainer.appendChild(item);
        });

        totalPriceEl.textContent = `Total: $${total.toFixed(2)}`;
      }

      renderCart();

      // Handle clicks inside cart container
      cartContainer.addEventListener('click', e => {
        const target = e.target;
        const index = target.dataset.index;

        if (target.classList.contains('remove-btn')) {
          cart.splice(index, 1);
          saveAndRender();
        }

        if (target.classList.contains('quantity-btn')) {
          const action = target.dataset.action;
          if (action === 'increase') {
            cart[index].quantity = (cart[index].quantity || 1) + 1;
          } else if (action === 'decrease') {
            if ((cart[index].quantity || 1) > 1) {
              cart[index].quantity -= 1;
            }
          }
          saveAndRender();
        }
      });

      // Remove all button
      removeAllBtn.addEventListener('click', () => {
        if (confirm('Are you sure you want to remove all items from your cart?')) {
          cart = [];
          saveAndRender();
        }
      });

      function saveAndRender() {
        localStorage.setItem('cart', JSON.stringify(cart));
        if (cart.length === 0) {
          cartContainer.innerHTML = '<p class="text-gray-400">Your cart is empty.</p>';
          totalPriceEl.style.display = 'none';
          removeAllBtn.style.display = 'none';
        } else {
          totalPriceEl.style.display = 'block';
          removeAllBtn.style.display = 'inline-block';
          renderCart();
        }
      }
    });
  </script>

</body>
</html>
